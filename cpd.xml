<?xml version="1.0" encoding="UTF-8"?>
<pmd-cpd>
<duplication lines="39" tokens="355">
<file line="1381" path="J:\Git\github\waarp-digest\WaarpAdministrator\src\main\java\org\waarp\openr66\serveraction\AdminR66OperationsGui.java"/>
<file line="1510" path="J:\Git\github\waarp-digest\WaarpAdministrator\src\main\java\org\waarp\openr66\serveraction\AdminR66OperationsGui.java"/>
<codefragment>
<![CDATA[
					if (ruleToGet == null || ruleToGet.isEmpty()) {
						message = Messages.getString("AdminR66OperationsGui.92"); //$NON-NLS-1$
					}
					if (message.length() > 1) {
						// error
						message = Messages.getString("RequestInformation.Failure")+Messages.getString("AdminR66OperationsGui.123") + message; //$NON-NLS-1$
					} else {
						if (getHost && shost != null && ! shost.isEmpty()) {
							future = new R66Future(true);
							DirectTransfer transfer = new DirectTransfer(future, host.getHostid(), shost,
									ruleToGet, Messages.getString("AdminR66OperationsGui.Hosts")+Messages.getString("AdminR66OperationsGui.GetConfig") //$NON-NLS-1$
											+ AdminGui.environnement.hostId,
									AdminGui.environnement.isMD5, Configuration.configuration.BLOCKSIZE,
									DbConstant.ILLEGALVALUE,
									AdminGui.environnement.networkTransaction);
							transfer.run();
							if (future.isSuccess()) {
								R66Result resultHost = future.getResult();
								shost = resultHost.file.getTrueFile().getAbsolutePath();
								message += Messages.getString("AdminR66OperationsGui.Hosts")+Messages.getString("AdminR66OperationsGui.FileInto") + shost+"\n"; //$NON-NLS-1$
							} else {
								getHost = false;
								shost = Messages.getString("AdminR66OperationsGui.CantGetFile")+Messages.getString("AdminR66OperationsGui.Hosts")+": " + shost; //$NON-NLS-1$
								message += shost;
							}
						}
						if (getRule && srule != null && ! srule.isEmpty()) {
							future = new R66Future(true);
							DirectTransfer transfer = new DirectTransfer(future, host.getHostid(), srule,
									ruleToGet, Messages.getString("AdminR66OperationsGui.Rules")+Messages.getString("AdminR66OperationsGui.GetConfig") //$NON-NLS-1$
											+ AdminGui.environnement.hostId,
									AdminGui.environnement.isMD5, Configuration.configuration.BLOCKSIZE,
									DbConstant.ILLEGALVALUE,
									AdminGui.environnement.networkTransaction);
							transfer.run();
							if (future.isSuccess()) {
								R66Result resultRule = future.getResult();
								srule = resultRule.file.getTrueFile().getAbsolutePath();
								message += Messages.getString("AdminR66OperationsGui.Rules")+Messages.getString("AdminR66OperationsGui.FileInto") + srule+"\n"; //$NON-NLS-1$
]]>
</codefragment>
</duplication>
<duplication lines="25" tokens="171">
<file line="1264" path="J:\Git\github\waarp-digest\WaarpAdministrator\src\main\java\org\waarp\openr66\serveraction\AdminR66OperationsGui.java"/>
<file line="1320" path="J:\Git\github\waarp-digest\WaarpAdministrator\src\main\java\org\waarp\openr66\serveraction\AdminR66OperationsGui.java"/>
<codefragment>
<![CDATA[
					sessionReadLimit.setValue(sr);
				}
			}
			if (result.code == ErrorCode.Warning) {
				message = Messages.getString("RequestInformation.Warned")+Messages.getString("AdminR66OperationsGui.70") + //$NON-NLS-1$
						(result.other != null ? sresult :
								Messages.getString("AdminR66OperationsGui.71")) //$NON-NLS-1$
						+ Messages.getString("AdminR66OperationsGui.72") + delay; //$NON-NLS-1$
			} else {
				message = Messages.getString("RequestInformation.Success")+Messages.getString("AdminR66OperationsGui.70") + //$NON-NLS-1$
						(result.other != null ? sresult :
								Messages.getString("AdminR66OperationsGui.71")) //$NON-NLS-1$
						+ Messages.getString("AdminR66OperationsGui.72") + delay; //$NON-NLS-1$
			}
		} else {
			if (result.code == ErrorCode.Warning) {
				message = Messages.getString("RequestInformation.Warned")+Messages.getString("AdminR66OperationsGui.70") + future.getCause(); //$NON-NLS-1$
			} else {
				message = Messages.getString("RequestInformation.Failure")+Messages.getString("AdminR66OperationsGui.70") + future.getCause(); //$NON-NLS-1$
			}
		}
		AdminGui.environnement.GuiResultat = message;
	}

	public void setBandwidth() {
]]>
</codefragment>
</duplication>
<duplication lines="17" tokens="113">
<file line="1231" path="J:\Git\github\waarp-digest\WaarpAdministrator\src\main\java\org\waarp\openr66\serveraction\AdminR66OperationsGui.java"/>
<file line="1300" path="J:\Git\github\waarp-digest\WaarpAdministrator\src\main\java\org\waarp\openr66\serveraction\AdminR66OperationsGui.java"/>
<codefragment>
<![CDATA[
				new ChangeBandwidthLimits(future, -1, -1, -1, -1,
						AdminGui.environnement.networkTransaction);
		bandwidthLimits.setHost(host);
		bandwidthLimits.run();
		future.awaitUninterruptibly();
		long time2 = System.currentTimeMillis();
		long delay = time2 - time1;
		R66Result result = future.getResult();
		String message = null;
		boolean useJson = PartnerConfiguration.useJson(host.getHostid());
		logger.debug("UseJson: "+useJson);
		if (future.isSuccess()) {
			String sresult = null;
			if (result.other != null) {
				if (useJson) {
					JsonCommandPacket packet = (JsonCommandPacket) result.other;
					sresult = packet.getRequest();
]]>
</codefragment>
</duplication>
</pmd-cpd>